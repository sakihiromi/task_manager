# Task Command Center ⚡

**やる気が出るタスク管理アプリ** - Notionライクなプロジェクト管理 + プランナー連携 + AI計画 + 会議書き起こし

![PWA](https://img.shields.io/badge/PWA-対応-6366f1)
![OpenAI](https://img.shields.io/badge/OpenAI-GPT--4o--mini%20%7C%20Whisper-10b981)
![Python](https://img.shields.io/badge/Python-3.9+-3776ab)
![JavaScript](https://img.shields.io/badge/JavaScript-ES6+-f7df1e)

---

## 📋 目次

1. [概要](#-概要)
2. [機能一覧](#-機能一覧)
3. [アーキテクチャ](#-アーキテクチャ)
4. [セットアップ](#-セットアップ)
5. [使い方ガイド](#-使い方ガイド)
6. [データ連携の仕組み](#-データ連携の仕組み)
7. [会議メモ・書き起こし機能](#-会議メモ書き起こし機能)
8. [AI計画機能](#-ai計画機能)
9. [API仕様](#-api仕様)
10. [データ構造](#-データ構造)
11. [ファイル構成](#-ファイル構成)
12. [カスタマイズ](#-カスタマイズ)
13. [トラブルシューティング](#-トラブルシューティング)
14. [セキュリティ](#-セキュリティ)
15. [今後の開発予定](#-今後の開発予定)

---

## 🎯 概要

Task Command Centerは、**ダッシュボード**、**プロジェクト管理**、**プランナー**、**会議メモ**の4つの機能が連携した統合タスク管理アプリです。

### コンセプト

- **ダッシュボード**: 全体を俯瞰する**表示専用**画面
- **プロジェクト**: 大きな目標を**サブタスクに分解**して管理
- **プランナー**: 年・月・週・日の**時間軸**でタスクを計画
- **会議メモ**: 録音・書き起こし・要約で**議事録を自動化**

### 特徴

| 特徴 | 説明 |
|------|------|
| 🔄 **完全連携** | プロジェクト↔プランナー↔ダッシュボードがリアルタイム連動 |
| 💾 **サーバー保存** | データはJSONファイルで永続化、アプリ再起動でもデータ保持 |
| 🎨 **モダンUI** | ダークテーマ、Notionスタイルのテーブル表示 |
| 📱 **PWA対応** | スマホ・デスクトップにアプリとしてインストール可能 |
| 🤖 **AI機能** | OpenAI GPT-4o-mini/Whisperで計画生成・書き起こし |

---

## ✨ 機能一覧

### 📊 ダッシュボード (`index.html`)

ダッシュボードは**表示専用**の統合ビューです。タスクの入力はプロジェクトまたはプランナーで行います。

#### 統計表示
| 項目 | 説明 |
|------|------|
| 完了率 | 全タスクに対する完了タスクの割合 |
| 完了タスク | 完了したタスクの総数 |
| 残りタスク | 未完了タスクの数 |
| 連続達成日数 | 毎日タスクを完了した連続日数 |
| 今日の期限 | 本日が期限のタスク数 |
| 今週の期限 | 今週が期限のタスク数 |

#### カテゴリ別タスク表示
| カテゴリ | アイコン | 説明 |
|----------|---------|------|
| 仕事 | 💼 | 業務関連タスク |
| 研究 | 🔬 | 研究・論文関連タスク |
| 学習 | 📚 | 学習・資格試験関連タスク |
| プライベート | 🏠 | 個人的なタスク |

#### プロジェクトグループ表示
- プロジェクトごとにタスクをグループ化
- **折りたたみ機能**: クリックでグループを開閉（状態はlocalStorageに保存）
- **進捗バー**: 完了数/総数とプログレスバーを表示
- **プロジェクトアイコン**: プロジェクトの絵文字アイコンを表示

#### 検索・フィルタ機能
| フィルタ | 説明 |
|----------|------|
| すべて | 全タスクを表示 |
| 未完了 | 完了していないタスクのみ |
| 期限超過 | 期限を過ぎた未完了タスク |
| 今日 | 今日が期限のタスク |
| 重要 | 優先度「高」のタスク |

#### ソート機能
| ソート | 説明 |
|--------|------|
| 優先度順 | 高→中→低の順 |
| 期限順 | 期限が近い順 |
| 作成日順 | 新しい順 |

#### アクティビティヒートマップ
- GitHubスタイルの過去30日間の活動記録
- プランナーで完了したタスクも含む
- 完了数に応じて色の濃さが変化

#### カレンダーウィジェット
- 月間カレンダー表示
- 期限のあるタスクをドットで表示
  - 🔵 タスク期限
  - 🟣 プロジェクト期限
  - 🟢 完了タスク
- 日付クリックで詳細モーダル表示
- プランナーのタスクも連動表示

#### ユーザー設定
- サイドバーのユーザー名をクリックで編集可能
- アバター（頭文字）も自動更新
- 設定はlocalStorageに保存

---

### 📂 プロジェクト管理 (`projects.html`)

プロジェクト単位でタスクを管理するメイン入力画面です。

#### ビュー切り替え
| ビュー | アイコン | 説明 |
|--------|---------|------|
| カテゴリビュー | 📁 | カテゴリ別にプロジェクトを分類（デフォルト） |
| ボードビュー | ▦ | ステータス別カンバン（企画中→進行中→完了→保留） |
| リストビュー | ☰ | シンプルなリスト表示 |
| テーブルビュー | ▤ | スプレッドシート形式 |

#### プロジェクト作成
| 項目 | 説明 |
|------|------|
| プロジェクト名 | 必須。プロジェクトの名前 |
| アイコン | 絵文字を選択（例: 📊, 🎯, 💡） |
| カテゴリ | 仕事/研究/学習/プライベート |
| ステータス | 企画中/進行中/完了/保留/アーカイブ |
| 期限 | プロジェクト全体の締め切り |
| 説明 | プロジェクトの詳細説明 |

#### サブタスク管理（Notionスタイル）
テーブル形式でサブタスクを管理:

| 列 | 説明 |
|----|------|
| チェックボックス | 完了/未完了の切り替え |
| タスク名 | サブタスクのタイトル |
| ステータス | 未着手/進行中/完了/保留 |
| 期限 | 日付/月/テキスト形式で設定可能 |
| 優先度 | 高(赤)/中(黄)/低(緑) |
| アクション | 編集・削除ボタン |

#### サブタスク詳細設定
| 項目 | 説明 |
|------|------|
| タイトル | タスク名 |
| 説明 | 詳細な説明文 |
| 期限タイプ | 日付指定/月指定/テキスト |
| 期限 | タイプに応じた期限設定 |
| 優先度 | 高/中/低 |

**期限タイプの詳細:**
- **日付指定**: `2026-01-15` のような具体的な日付
- **月指定**: `2026-01` のような月単位（「1月中」と表示）
- **テキスト**: 「来週中」「ASAP」などの自由テキスト

#### ドラッグ＆ドロップ
- サブタスクの順番をドラッグで変更可能
- 変更は即座にサーバーに保存

#### プロジェクトカード展開
- カテゴリビューでプロジェクトカードをクリック
- サブタスクがNotionスタイルのテーブルで展開表示
- 展開状態からも編集・削除が可能

---

### 📅 プランナー (`planner.html`)

時間軸でタスクを計画するビューです。

#### ビュー切り替え
| ビュー | 説明 |
|--------|------|
| 年間 | 1年間の目標を設定 |
| 月間 | 月単位の計画（デフォルト） |
| 週間 | 週単位のカレンダー表示 |

#### 年間目標
カテゴリ別に年間目標を設定:
- 💼 仕事
- 📚 学習
- 💪 健康
- 🎯 その他

各カテゴリで複数の目標を追加可能。

#### 月間プラン

##### 今月やること
手動で追加するTODOリスト:
- テキスト入力でタスク追加
- **ラベル設定**: 仕事/研究/学習/プライベート
- ラベルに応じて自動的にカテゴリ別セクションに振り分け
- ドラッグ＆ドロップで並び替え
- チェックボックスで完了（カテゴリ側と連動）

##### プロジェクト連携
今月期限のプロジェクトタスクを自動表示:
- プロジェクトごとにグループ化
- **折りたたみ機能**: クリックで開閉（状態保存）
- 完了チェック（プロジェクト側と連動）
- 「+」ボタンでサブタスク追加
- 編集・削除ボタン
- 進捗表示（完了数/総数）

##### カテゴリ別セクション
ラベルに応じて自動振り分け:
- 💼 仕事
- 🔬 研究
- 📚 学習
- 🏠 プライベート

各セクションは折りたたみ可能。

#### 週間プラン

##### 週のTODO
- 週単位のTODOリスト
- ドラッグ＆ドロップで並び替え
- ホバーで削除ボタン表示

##### 日別タスク
- 7日間のカレンダー形式
- 各日にタスクを追加
- チェックボックスで完了
- ドラッグ＆ドロップで並び替え
- ホバーで削除ボタン表示

#### 完了日記録
- タスク完了時に`completedAt`を自動記録
- ダッシュボードのヒートマップに反映
- カレンダーに完了マークを表示

---

### 🎙️ 会議メモ (`meetings.html`)

会議の録音・書き起こし・議事録作成を行います。

#### 録音機能
| 機能 | 説明 |
|------|------|
| 🎤 マイク録音 | ブラウザのマイクで直接録音 |
| 🖥️ システム音声 | PC/タブの音声を録音（画面共有経由） |
| 📁 ファイルアップロード | 音声/動画ファイルをアップロード |

#### 対応フォーマット
- 音声: mp3, wav, webm, m4a, ogg
- 動画: mp4, mov, avi

#### AI機能
| 機能 | 説明 |
|------|------|
| 📝 書き起こし | Whisper APIで音声→テキスト変換 |
| ✨ AI要約 | 5-10個の箇条書きで要約 |
| 📋 議事録作成 | フォーマット済み議事録を生成 |
| ⚡ アクション抽出 | 次のアクションを自動抽出 |

#### 会議メモ管理
- プロジェクト別にグループ化
- 日付・参加者・内容を記録
- アクションアイテムを登録

---

### 💾 データ永続化

#### サーバーサイド保存
- PythonサーバーがJSONファイルとして保存
- `data/`フォルダに自動作成
- 変更時にデバウンス付きで自動保存

#### ローカルストレージ
- サーバー接続失敗時のフォールバック
- 折りたたみ状態の保存
- ユーザー設定の保存

#### データファイル一覧
| ファイル | 内容 |
|---------|------|
| `data/tasks.json` | ダッシュボード直接入力タスク |
| `data/projects.json` | プロジェクト・サブタスク |
| `data/planner.json` | 年間目標・月間/週間/日別タスク |
| `data/memos.json` | 会議メモ |
| `data/meetings.json` | 会議データ |

---

### 📲 PWA対応

- **インストール可能**: Chrome/Edge/Safariからホーム画面に追加
- **オフライン対応**: Service Workerでキャッシュ
- **アイコン**: 各サイズのPWAアイコンを用意

---

## 🏗️ アーキテクチャ

### システム構成図

```
┌─────────────────────────────────────────────────────────────┐
│                       ブラウザ (Frontend)                    │
├─────────────────────────────────────────────────────────────┤
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
│  │index.html│  │projects │  │planner  │  │meetings │        │
│  │ダッシュ  │  │.html    │  │.html    │  │.html    │        │
│  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘        │
│       │            │            │            │              │
│  ┌────┴────────────┴────────────┴────────────┴────┐        │
│  │                  JavaScript                      │        │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐   │        │
│  │  │data.js │ │app.js  │ │projects│ │planner │   │        │
│  │  │        │ │        │ │.js     │ │.js     │   │        │
│  │  └────────┘ └────────┘ └────────┘ └────────┘   │        │
│  │  ┌────────┐ ┌────────┐ ┌────────┐ ┌────────┐   │        │
│  │  │calendar│ │stats.js│ │meetings│ │ai_     │   │        │
│  │  │.js     │ │        │ │.js     │ │planner │   │        │
│  │  └────────┘ └────────┘ └────────┘ └────────┘   │        │
│  └──────────────────────────────────────────────────┘        │
│                           │                                  │
│                     Fetch API                                │
└───────────────────────────┼──────────────────────────────────┘
                            │
                            ▼
┌───────────────────────────────────────────────────────────────┐
│                    Python Server (server.py)                  │
├───────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐                    │
│  │ Static Files    │  │ API Endpoints   │                    │
│  │ (HTML/CSS/JS)   │  │                 │                    │
│  └─────────────────┘  │ /api/data/*     │                    │
│                       │ /api/generate   │                    │
│                       │ /api/summarize  │                    │
│                       │ /api/transcribe │                    │
│                       └────────┬────────┘                    │
│                                │                              │
│  ┌─────────────────┐  ┌────────┴────────┐                    │
│  │ data/ フォルダ   │  │ OpenAI API      │                    │
│  │ (JSON保存)      │  │ (外部サービス)   │                    │
│  └─────────────────┘  └─────────────────┘                    │
└───────────────────────────────────────────────────────────────┘
```

### データフロー

```
                    ┌─────────────┐
                    │   入力      │
                    └──────┬──────┘
                           │
           ┌───────────────┼───────────────┐
           ▼               ▼               ▼
    ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
    │ プロジェクト │ │  プランナー  │ │  会議メモ   │
    │ (projects)  │ │  (planner)  │ │  (meetings) │
    └──────┬──────┘ └──────┬──────┘ └──────┬──────┘
           │               │               │
           ▼               ▼               ▼
    ┌─────────────────────────────────────────────┐
    │              サーバー保存                    │
    │        (data/*.json ファイル)               │
    └──────────────────────┬──────────────────────┘
                           │
                           ▼
    ┌─────────────────────────────────────────────┐
    │            ダッシュボード（表示）            │
    │  - プロジェクトタスク表示                   │
    │  - カレンダー（プランナー連動）             │
    │  - アクティビティログ（プランナー連動）      │
    │  - 統計・チャート                          │
    └─────────────────────────────────────────────┘
```

---

## 🚀 セットアップ

### 動作要件

| 項目 | 要件 |
|------|------|
| Python | 3.9以上 |
| ブラウザ | Chrome, Edge, Firefox, Safari (最新版推奨) |
| OpenAI APIキー | AI機能を使用する場合に必要 |

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd task_management_dashboard
```

### 2. 仮想環境の作成

```bash
# 仮想環境を作成
python -m venv venv_task

# 仮想環境を有効化
# macOS / Linux:
source venv_task/bin/activate

# Windows (コマンドプロンプト):
venv_task\Scripts\activate

# Windows (PowerShell):
venv_task\Scripts\Activate.ps1
```

### 3. 依存関係のインストール

```bash
pip install -r requirements.txt
```

**requirements.txt の内容:**
```
python-dotenv>=1.0.0
```

### 4. 環境変数の設定

プロジェクトのルートディレクトリに `.env` ファイルを作成:

```bash
# ============================================
# Task Command Center 設定
# ============================================

# OpenAI API Key (AI機能に必要)
OPENAI_API_KEY=sk-your-api-key-here

# サーバーポート (オプション、デフォルト: 8009)
TASK_DASHBOARD_PORT=8009
```

**OpenAI APIキーの取得方法:**
1. https://platform.openai.com/ にアクセス
2. アカウント作成/ログイン
3. API Keys → Create new secret key
4. キーをコピーして `.env` に貼り付け

### 5. サーバーの起動

```bash
python server.py
```

**起動成功時の出力:**
```
==================================================
🚀 Task Command Center - PWA Server
==================================================
📍 Server running at: http://localhost:8009
📍 Data directory: data/
📍 API Endpoints:
   - /api/data/*      (Data Persistence)
   - /api/generate    (AI Task Planning)
   - /api/summarize   (Meeting Summarization)
   - /api/transcribe  (Whisper Speech-to-Text)

✅ API Key loaded
==================================================
```

### 6. ブラウザでアクセス

| ページ | URL | 説明 |
|--------|-----|------|
| ダッシュボード | http://localhost:8009/ | メイン画面（表示専用） |
| プロジェクト | http://localhost:8009/projects.html | プロジェクト・サブタスク管理 |
| プランナー | http://localhost:8009/planner.html | 年間・月間・週間計画 |
| 会議メモ | http://localhost:8009/meetings.html | 録音・書き起こし |

### 7. PWAとしてインストール（オプション）

**Chrome/Edgeの場合:**
1. 上記URLにアクセス
2. アドレスバー右側のインストールアイコン（⊕）をクリック
3. 「インストール」をクリック

**iPhone/iPad (Safari):**
1. 共有ボタン → 「ホーム画面に追加」

---

## 📖 使い方ガイド

### 基本的なワークフロー

```
1. プロジェクト作成
   ↓
2. サブタスク追加（期限・優先度設定）
   ↓
3. プランナーで確認・追加タスク入力
   ↓
4. ダッシュボードで全体確認
   ↓
5. タスク完了 → 自動でログ記録
```

### プロジェクトでの作業

#### プロジェクト作成

1. 「+ 新規プロジェクト」ボタンをクリック
2. 必要情報を入力:
   - プロジェクト名（必須）
   - アイコン（絵文字を選択）
   - カテゴリ（仕事/研究/学習/プライベート）
   - ステータス（企画中/進行中/完了/保留）
   - 期限（オプション）
   - 説明（オプション）
3. 「作成」をクリック

#### サブタスク追加

1. プロジェクト詳細画面を開く
2. 「+ タスクを追加」をクリック
3. タスク情報を入力:
   - タイトル
   - 説明（オプション）
   - 期限タイプを選択:
     - **日付**: 具体的な日付を選択
     - **月**: 月を選択（「1月中」と表示）
     - **テキスト**: 自由テキスト
   - 優先度（高/中/低）
4. 「保存」をクリック

#### サブタスクの並び替え

1. サブタスク行の左側のドラッグハンドル（⠿）をつかむ
2. 目的の位置にドラッグ
3. ドロップで完了（自動保存）

### プランナーでの作業

#### 月間計画

1. 「月間」ビューを選択
2. **今月やること**セクションで:
   - テキスト入力でタスク追加
   - ラベルを選択（仕事/研究/学習/プライベート）
   - 追加したタスクは自動でカテゴリ別セクションにも表示
3. **プロジェクトから**セクションで:
   - 今月期限のプロジェクトタスクが自動表示
   - 「+」ボタンでサブタスク追加
   - プロジェクトグループをクリックで折りたたみ

#### 週間計画

1. 「週間」ビューを選択
2. **週のTODO**に今週やることを追加
3. **日別カレンダー**で各日にタスクを追加
4. ドラッグ＆ドロップで並び替え

### ダッシュボードでの確認

1. 統計を確認（完了率、残りタスクなど）
2. カテゴリ別にタスクを確認
3. 折りたたみでプロジェクトグループを開閉
4. 検索・フィルタで特定タスクを表示
5. カレンダーで期限を確認

### ユーザー名の変更

1. サイドバーのユーザー名（デフォルト: User）をクリック
2. 新しい名前を入力
3. OKで保存
4. 全ページで反映（アバターも自動更新）

---

## 🔗 データ連携の仕組み

### プロジェクト → ダッシュボード

1. プロジェクトのサブタスクがダッシュボードのカテゴリ別セクションに表示
2. プロジェクト名・アイコン・進捗も表示
3. 完了チェックは双方向で同期

### プロジェクト → プランナー

1. 今月期限（`deadline`が今月、または`deadlineType: 'month'`で今月）のタスクを自動表示
2. 「プロジェクトから」セクションにグループ化して表示
3. 完了チェックは双方向で同期
4. プランナーからサブタスク追加可能

### プランナー → ダッシュボード

1. **カレンダー連動**:
   - 日別タスクの期限をカレンダーに表示
   - 完了タスクをカレンダーにマーク
   - 月間TODOの完了もカレンダーに反映

2. **アクティビティログ連動**:
   - プランナーでタスク完了時に`completedAt`を記録
   - ヒートマップに完了数を反映
   - 日別/週別/月別すべて対象

### データ同期のタイミング

| アクション | 同期 |
|-----------|------|
| タスク完了 | 即時（デバウンス500ms） |
| タスク追加 | 即時 |
| タスク削除 | 即時 |
| 並び替え | 即時 |
| 設定変更 | 即時（localStorage） |

---

## 🎙️ 会議メモ・書き起こし機能

### マイク録音の手順

1. 「🎤 マイク録音」ボタンをクリック
2. ブラウザのマイクアクセス許可ダイアログで「許可」
3. 録音中は時間がカウントされます
4. 「⏹️ 録音停止」で終了
5. 自動的にWhisper APIで書き起こし開始
6. 書き起こし完了後、テキストが表示されます

### システム音声録音の手順

イヤホン使用時でもPCの音声（Teams/Zoomなど）を録音できます。

1. 「🖥️ システム音声」ボタンをクリック
2. 画面共有ダイアログが表示されます
3. 録音したい音声のソースを選択:
   - **Chromeタブ**: 特定のタブの音声のみ
   - **画面全体**: PC全体の音声
4. **重要**: 「タブの音声も共有」または「システム音声を共有」にチェック
5. 「共有」をクリック
6. 録音開始 → 「⏹️ 録音停止」で終了
7. 自動的に書き起こし

### ファイルアップロード

1. 「📁 ファイルアップロード」エリアをクリック
2. 音声/動画ファイルを選択（またはドラッグ＆ドロップ）
3. 対応形式: mp3, wav, webm, m4a, mp4, mov
4. アップロード後、自動的に書き起こし

### AI機能の使い方

書き起こしテキストが表示された後:

| ボタン | 機能 | 出力 |
|--------|------|------|
| ✨ AI要約 | 内容を要約 | 5-10個の箇条書き |
| 📋 議事録作成 | フォーマット済み議事録 | 日時・参加者・議題・決定事項・アクション |
| ⚡ アクション抽出 | 次のアクションを抽出 | タスクリスト（担当者付き） |

---

## 🤖 AI計画機能

### 概要

目標を入力すると、詳細なタスク計画を自動生成します。

### 使い方

1. ダッシュボードの「✨ AI計画」ボタンをクリック
2. 以下を入力:
   - **目標**: 例「TOEICスコア900点」「機械学習論文投稿」
   - **タイプ**: 資格試験/研究/仕事/スキル習得
   - **レベル**: 初心者/中級者/上級者
   - **週あたり時間**: 利用可能な学習/作業時間
   - **期限**: 目標達成日
3. 「計画を生成」をクリック
4. 生成されたタスクをプレビュー
5. 「タスクをインポート」でプロジェクトに追加

### 生成される内容

- **おすすめ教材**: 具体的な書籍・コース名
- **週ごとの計画**: 第1週〜最終週までの詳細
- **サブタスク**: 各タスクに5-8個の具体的なアクション
- **学習時間の目安**: 各タスクの所要時間

---

## 📡 API仕様

### データ永続化API

#### GET /api/data
全データを取得

**レスポンス:**
```json
{
  "tasks": [...],
  "memos": [...],
  "projects": [...],
  "meetings": [...],
  "planner": {...}
}
```

#### POST /api/data
全データを保存

#### GET /api/data/tasks
タスクデータを取得

#### POST /api/data/tasks
タスクデータを保存

**リクエスト:**
```json
[
  {
    "id": "task_1234567890",
    "title": "タスク名",
    "category": "work",
    "priority": "high",
    "deadline": "2026-01-15",
    "completed": false,
    "projectName": "プロジェクトA"
  }
]
```

#### GET /api/data/projects
プロジェクトデータを取得

#### POST /api/data/projects
プロジェクトデータを保存

**リクエスト:**
```json
[
  {
    "id": "proj_1234567890",
    "name": "プロジェクト名",
    "icon": "📊",
    "category": "research",
    "status": "active",
    "deadline": "2026-03-31",
    "description": "説明文",
    "tasks": [
      {
        "id": "subtask_1234567890",
        "title": "サブタスク名",
        "description": "",
        "deadlineType": "month",
        "deadline": "2026-01",
        "priority": "high",
        "status": "pending",
        "completed": false,
        "completedAt": null
      }
    ]
  }
]
```

#### GET /api/data/planner
プランナーデータを取得

#### POST /api/data/planner
プランナーデータを保存

**リクエスト:**
```json
{
  "yearGoals": {
    "2026": {
      "work": ["目標1", "目標2"],
      "study": ["目標3"]
    }
  },
  "monthPlans": {
    "2026-01": {
      "quote": "今月の一言",
      "todos": [
        {
          "text": "タスク名",
          "completed": false,
          "completedAt": null,
          "label": "work"
        }
      ]
    }
  },
  "weekPlans": {
    "week-2026-01-05": {
      "message": "今週のメッセージ",
      "todos": [
        {
          "text": "週のTODO",
          "completed": false,
          "completedAt": null
        }
      ]
    }
  },
  "dailyTasks": {
    "2026-01-05": [
      {
        "text": "日のタスク",
        "completed": true,
        "completedAt": "2026-01-05T12:00:00.000Z"
      }
    ]
  }
}
```

### AI API

#### POST /api/generate
AIタスク計画の生成

**リクエスト:**
```json
{
  "goal": "TOEICスコア900点",
  "deadline": "2026-06-30",
  "goalType": "資格試験",
  "category": "study",
  "level": "intermediate",
  "hoursPerWeek": "10"
}
```

**レスポンス:**
```json
{
  "choices": [{
    "message": {
      "content": "{\"tasks\": [...]}"
    }
  }]
}
```

#### POST /api/summarize
会議内容の要約・議事録生成

**リクエスト:**
```json
{
  "text": "会議の書き起こしテキスト...",
  "type": "summary|minutes|actions",
  "title": "週次定例会議",
  "participants": "山田, 佐藤"
}
```

**レスポンス (summary/minutes):**
```json
{
  "result": "要約または議事録テキスト"
}
```

**レスポンス (actions):**
```json
{
  "actions": [
    {"title": "アクション内容", "assignee": "担当者"}
  ]
}
```

#### POST /api/transcribe
音声ファイルの書き起こし

**リクエスト:** `multipart/form-data`
- `audio`: 音声ファイル (webm, mp3, wav, m4a)

**レスポンス:**
```json
{
  "text": "書き起こされたテキスト",
  "success": true
}
```

---

## 📊 データ構造

### タスク (Task)

```javascript
{
  id: "task_1234567890",      // ユニークID
  title: "タスク名",           // タスクタイトル
  category: "work",           // カテゴリ (work/research/study/private)
  priority: "high",           // 優先度 (high/medium/low)
  deadline: "2026-01-15",     // 期限 (YYYY-MM-DD)
  completed: false,           // 完了状態
  completedAt: null,          // 完了日時 (ISO8601)
  projectName: "プロジェクトA", // 所属プロジェクト名
  createdAt: "2026-01-01..."  // 作成日時
}
```

### プロジェクト (Project)

```javascript
{
  id: "proj_1234567890",      // ユニークID
  name: "プロジェクト名",      // プロジェクト名
  icon: "📊",                 // 絵文字アイコン
  category: "research",       // カテゴリ
  status: "active",           // ステータス (planning/active/completed/on-hold/archived)
  deadline: "2026-03-31",     // 期限
  description: "説明文",       // 説明
  tasks: [                    // サブタスク配列
    {
      id: "subtask_123",
      title: "サブタスク名",
      description: "詳細説明",
      deadlineType: "month",  // 期限タイプ (date/month/text)
      deadline: "2026-01",    // 期限値
      priority: "high",
      status: "pending",
      completed: false,
      completedAt: null
    }
  ],
  createdAt: "2026-01-01..."
}
```

### プランナー (Planner)

```javascript
{
  yearGoals: {
    "2026": {
      work: ["目標1", "目標2"],
      study: ["目標3"],
      health: [],
      other: []
    }
  },
  monthPlans: {
    "2026-01": {
      quote: "今月の一言",
      todos: [
        {
          text: "タスク名",
          completed: false,
          completedAt: null,
          label: "work"
        }
      ]
    }
  },
  weekPlans: {
    "week-2026-01-05": {
      message: "今週のメッセージ",
      todos: [...],
      ongoingNotes: "",
      deadlineNotes: ""
    }
  },
  dailyTasks: {
    "2026-01-05": [
      {
        text: "日のタスク",
        completed: true,
        completedAt: "2026-01-05T12:00:00.000Z"
      }
    ]
  }
}
```

---

## 📁 ファイル構成

```
task_management_dashboard/
├── index.html              # ダッシュボード（表示専用）
├── projects.html           # プロジェクト管理
├── planner.html            # プランナー
├── meetings.html           # 会議メモ
├── offline.html            # オフラインページ
├── manifest.json           # PWAマニフェスト
├── sw.js                   # Service Worker
├── server.py               # Pythonバックエンド
├── requirements.txt        # Python依存関係
├── README.md               # このファイル
│
├── data/                   # サーバーサイドデータ保存（自動生成）
│   ├── tasks.json          # タスクデータ
│   ├── projects.json       # プロジェクトデータ
│   ├── planner.json        # プランナーデータ
│   ├── memos.json          # 会議メモデータ
│   └── meetings.json       # 会議データ
│
├── css/
│   ├── style.css           # メインスタイル（ダッシュボード）
│   ├── projects.css        # プロジェクトページ用
│   ├── planner.css         # プランナーページ用
│   ├── meetings.css        # 会議ページ用
│   ├── calendar_subtasks.css # カレンダーサブタスク用
│   └── responsive.css      # レスポンシブ対応
│
├── js/
│   ├── data.js             # データ管理
│   │                       #   - TaskManager: タスク管理
│   │                       #   - ProjectsManager: プロジェクト管理
│   │                       #   - UserSettings: ユーザー設定
│   ├── app.js              # ダッシュボードUI
│   │                       #   - 検索・フィルタ
│   │                       #   - 折りたたみ状態管理
│   │                       #   - プロジェクトタスク表示
│   ├── projects.js         # プロジェクトUI
│   │                       #   - ビュー切り替え
│   │                       #   - Notionスタイルテーブル
│   │                       #   - ドラッグ＆ドロップ
│   ├── planner.js          # プランナーUI
│   │                       #   - 年/月/週ビュー
│   │                       #   - ラベル・自動振り分け
│   │                       #   - プロジェクト連携
│   │                       #   - ドラッグ＆ドロップ
│   ├── meetings.js         # 会議メモUI
│   │                       #   - 録音機能
│   │                       #   - Whisper書き起こし
│   │                       #   - AI要約・議事録
│   ├── calendar.js         # カレンダーウィジェット
│   │                       #   - プランナーデータ連動
│   │                       #   - プロジェクト期限表示
│   ├── stats.js            # 統計・チャート
│   │                       #   - ヒートマップ
│   │                       #   - カテゴリチャート
│   │                       #   - プランナーデータ連動
│   ├── ai_planner.js       # AI計画機能
│   └── gamification.js     # ゲーミフィケーション（将来）
│
├── icons/                  # PWAアイコン
│   ├── icon.svg            # ベースアイコン
│   ├── icon-72.png
│   ├── icon-96.png
│   ├── icon-128.png
│   ├── icon-144.png
│   ├── icon-152.png
│   ├── icon-192.png
│   ├── icon-384.png
│   ├── icon-512.png
│   └── generator.html      # アイコン生成ツール
│
└── docs/                   # ドキュメント
    └── task_manager_project/
        ├── implementation_plan.md
        └── walkthrough.md
```

---

## 🎨 カスタマイズ

### カテゴリの変更

`js/data.js` の `CATEGORIES` を編集:

```javascript
const CATEGORIES = {
    work: { name: '仕事', icon: '💼', color: '#3b82f6' },
    research: { name: '研究', icon: '🔬', color: '#10b981' },
    study: { name: '学習', icon: '📚', color: '#f59e0b' },
    private: { name: 'プライベート', icon: '🏠', color: '#ec4899' },
    // 新しいカテゴリを追加
    hobby: { name: '趣味', icon: '🎨', color: '#8b5cf6' }
};
```

**注意**: カテゴリを追加する場合は以下も更新が必要:
- `index.html`: カテゴリカード追加
- `projects.html`: サイドバー・フォーム更新
- `planner.html`: カテゴリセクション追加
- `js/app.js`: `renderCategoryTasks`の配列に追加
- `js/projects.js`: `CATEGORY_CONFIG`に追加
- `js/planner.js`: `LABELS`に追加

### テーマカラーの変更

`css/style.css` の CSS 変数を編集:

```css
:root {
    /* メインカラー */
    --accent-primary: #6366f1;    /* 紫（メイン） */
    --accent-secondary: #8b5cf6;  /* 明るい紫 */
    
    /* ステータスカラー */
    --accent-success: #10b981;    /* 緑（成功） */
    --accent-warning: #f59e0b;    /* 黄（警告） */
    --accent-danger: #ef4444;     /* 赤（危険） */
    --accent-info: #3b82f6;       /* 青（情報） */
    
    /* グラデーション */
    --gradient-hero: linear-gradient(135deg, #6366f1 0%, #ec4899 100%);
    
    /* 背景色 */
    --bg-primary: #0f0f12;        /* 最も暗い背景 */
    --bg-secondary: #16161d;      /* セカンダリ背景 */
    --bg-card: #1a1a23;           /* カード背景 */
    --bg-hover: #22222d;          /* ホバー時 */
    
    /* テキスト */
    --text-primary: #f4f4f5;      /* メインテキスト */
    --text-secondary: #a1a1aa;    /* セカンダリテキスト */
    --text-muted: #71717a;        /* 薄いテキスト */
    --text-accent: #a78bfa;       /* アクセントテキスト */
    
    /* ボーダー */
    --border-subtle: rgba(255, 255, 255, 0.08);
    --border-light: rgba(255, 255, 255, 0.12);
}
```

### ライトテーマの作成

`css/style.css` に以下を追加:

```css
@media (prefers-color-scheme: light) {
    :root {
        --bg-primary: #ffffff;
        --bg-secondary: #f4f4f5;
        --bg-card: #ffffff;
        --text-primary: #18181b;
        --text-secondary: #52525b;
        --text-muted: #a1a1aa;
        --border-subtle: rgba(0, 0, 0, 0.08);
    }
}
```

---

## 🔧 トラブルシューティング

### サーバーが起動しない

#### ポートが使用中

```bash
# ポート8009を使用しているプロセスを確認
lsof -i:8009

# 強制終了
lsof -ti:8009 | xargs kill -9

# サーバー再起動
python server.py
```

#### 別のポートを使用

```bash
# 環境変数でポート指定
TASK_DASHBOARD_PORT=8010 python server.py
```

### データが保存されない

1. **サーバーが起動しているか確認**
   ```bash
   curl http://localhost:8009/api/data/projects
   ```

2. **data/フォルダの権限を確認**
   ```bash
   ls -la data/
   ```

3. **ブラウザのコンソールでエラーを確認**
   - F12 → Console タブ

4. **ネットワークリクエストを確認**
   - F12 → Network タブ
   - `/api/data/*` へのリクエストを確認

### 折りたたみ状態がリセットされる

- `localStorage`をクリアすると状態がリセットされます
- ブラウザのプライベートモードでは保存されません

**localStorage確認方法:**
- F12 → Application → Local Storage → http://localhost:8009

### AI機能が動作しない

1. **APIキーの確認**
   ```bash
   # .envファイルの内容確認
   cat .env | grep OPENAI
   ```

2. **APIキーの有効性確認**
   - https://platform.openai.com/api-keys でステータス確認

3. **残高確認**
   - https://platform.openai.com/usage で残高確認

4. **サーバーログ確認**
   - サーバー起動時に「✅ API Key loaded」が表示されているか

### マイクが使えない

1. **ブラウザの権限確認**
   - アドレスバーの鍵アイコン → サイトの設定 → マイク → 許可

2. **システムの権限確認**
   - macOS: システム環境設定 → セキュリティとプライバシー → マイク
   - Windows: 設定 → プライバシー → マイク

### システム音声が録音されない

1. **「タブの音声を共有」にチェック**を確認
2. **DRM保護されたコンテンツ**は録音できません
3. **一部のアプリ**（Spotify等）は保護されている場合があります

### Service Workerのキャッシュ問題

ファイルを更新しても反映されない場合:

1. **DevTools (F12) → Application → Service Workers**
2. 「Unregister」をクリック
3. ページをハードリロード（Ctrl+Shift+R）

または:

```javascript
// コンソールで実行
navigator.serviceWorker.getRegistrations().then(registrations => {
    registrations.forEach(registration => registration.unregister());
});
```

---

## 🔒 セキュリティ

### APIキーの保護

- ✅ APIキーは**サーバー側 (`server.py`)** でのみ使用
- ✅ ブラウザ（JavaScript）には**一切露出しない**
- ✅ `.env`ファイルは`.gitignore`に含まれている
- ✅ APIキーはログに出力しない（末尾4文字のみ表示）

**通信フロー:**
```
ブラウザ → localhost:8009/api/... → server.py → OpenAI API
              (APIキーなし)         (APIキーあり)
```

### データの保存場所

| データ | 保存場所 | 暗号化 |
|--------|----------|--------|
| タスク・プロジェクト | サーバー (data/*.json) | なし |
| 折りたたみ状態 | ブラウザ (localStorage) | なし |
| ユーザー設定 | ブラウザ (localStorage) | なし |

### 本番環境にデプロイする場合

1. **HTTPS必須**: Let's Encryptなどで証明書を取得
2. **CORS設定**: 許可するオリジンを制限
3. **レート制限**: APIの過剰使用を防ぐ
4. **認証追加**: ユーザー認証を実装
5. **データ暗号化**: 機密データは暗号化して保存
6. **バックアップ**: 定期的にデータをバックアップ

---

## 🚧 今後の開発予定

### 予定している機能

- [ ] **通知機能**: 期限前にブラウザ通知
- [ ] **繰り返しタスク**: 毎日/毎週/毎月の定期タスク
- [ ] **タグ機能**: タスクにタグを付けて横断的に管理
- [ ] **ダークモード切り替え**: ライトテーマ対応
- [ ] **データエクスポート**: CSV/JSONエクスポート
- [ ] **データインポート**: 他アプリからのインポート
- [ ] **マルチユーザー**: 複数ユーザー対応
- [ ] **共有機能**: プロジェクトの共有
- [ ] **モバイル最適化**: スマホ専用UI

### 検討中の機能

- [ ] **Googleカレンダー連携**
- [ ] **Slack連携**
- [ ] **GitHub連携**
- [ ] **Notion連携**
- [ ] **音声コマンド**

---

## 📄 ライセンス

MIT License

---

## 🙏 謝辞

- [OpenAI](https://openai.com/) - GPT-4o-mini / Whisper API
- [Chart.js](https://www.chartjs.org/) - グラフ描画
- [Outfit Font](https://fonts.google.com/specimen/Outfit) - フォント

---

## 📞 サポート

問題が発生した場合は、以下を確認してください:

1. このREADMEのトラブルシューティングセクション
2. ブラウザのコンソールログ (F12)
3. サーバーのログ出力
4. `data/`フォルダの内容

---

**Happy Tasking! ⚡**
